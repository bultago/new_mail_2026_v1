<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.terracetech.tims.webmail.MailSharedFolder.mapper.MailSharedFolderMapper">	
	
	<select id="readSharedFolderList" parameterType="int" resultMap="sharedFolderResult">		
		select sf.folder_uid, sf.folder_name, m.mail_user_seq , mi.user_name, m.mail_uid
			from mail_user m, mail_user_info mi,mail_shared_folder sf ,mail_shared_folder_reader sr
		where
			 sr.mail_user_seq = #{userSeq} and sr.folder_uid = sf.folder_uid 
			 and sf.mail_user_seq = m.mail_user_seq
			 and mi.mail_user_seq = sf.mail_user_seq
	</select>
	
	<select id="readSharedFolderReaderList" parameterType="int" resultMap="sharedFolderUserResult">		
		select m.mail_user_seq ,m.mail_uid, i.user_name
			from mail_user m, mail_shared_folder_reader sr, mail_user_info i
		where
			 sr.folder_uid = #{folderUid}  
			 and sr.mail_user_seq = m.mail_user_seq
			 and i.mail_user_seq = m.mail_user_seq
	</select>
	
	<select id="readUserSharedFolder" parameterType="int" resultMap="sharedFolderList">
		select folder_uid, folder_name, mail_user_seq
		from mail_shared_folder
		where mail_user_seq = #{userSeq}
	</select>
	
	<select id="readFolderUid" parameterType="sharedFolder" resultType="int">
		select folder_uid
		from mail_shared_folder
		where mail_user_seq = #{sharedUserSeq} and folder_name = #{folderName}
	</select>	
	
	<insert id="saveSharedFolder" parameterType="sharedFolder">
		insert into mail_shared_folder (mail_user_seq,folder_name) values (#{sharedUserSeq:INTEGER},#{folderName:VARCHAR})	
	</insert>
	
	<update id="updateSharedFolder" parameterType="sharedFolder">
		update mail_shared_folder set folder_name = #{folderName} where folder_uid = #{folderUid}
	</update>
	
	<delete id="removeSharedFolder" parameterType="int">
		delete from mail_shared_folder where folder_uid = #{folderSeq}
	</delete>
	
	<insert id="saveSharedFolderReader" parameterType="sharedUser">		
		insert into mail_shared_folder_reader values (#{folderUid:INTEGER},#{userSeq:INTEGER})	
	</insert>
		
	<delete id="removeSharedFolderReader" parameterType="int">
		delete from mail_shared_folder_reader where folder_uid = #{folderSeq}
	</delete>
</mapper>