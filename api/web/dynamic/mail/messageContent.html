<html>
<head>
<script type="text/javascript" src="/js/core-lib/jquery-1.3.2.js"></script>
<script type="text/javascript" src="/js/ext-lib/noclick.js"></script>
<style type="text/css">
    body {
        margin:0px;
        padding:0px;
        font-family: "돋움",Dotum,"굴림",Gulim,"MS PGothic", "Osaka", Arial,AppleGothic,Sans-serif;
        font-size: 12px;    
    }
    .TerraceMsg{line-height: normal !important;}
    p{ margin: 0; padding: 0; line-height: 1.5; font-size:12px;}
    P.MsoNormal{*text-align: left  !important; *text-justify:auto !important;}
    .MsoNormal{*text-align: auto !important;*width:auto !important; margin:auto !important;text-indent: 0px !important;}
    .MsoListParagraph{*text-align: left !important;*width:auto !important;}
    .MsoNormalTable {margin:auto !important;}
</style>

<script type="text/javascript"> 
    var resizeDone = false;
    var resizeCnt = 0;
    var interval;

    //kimmw@daou.co.kr 20150703
    function escapeHtml(string) {
        var entityMap = {
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': '&quot;',
                "'": '&#39;',
                "/": '&#x2F;'
              };        
        return String(string).replace(/[&<>"'\/]/g, function (s) {
          return entityMap[s];
        });
     }
    
    //kimmw@daou.co.kr 20150703    
    function setContent(){
        var strMessageText = parent.getMessageText();
        strMessageText = strMessageText.split(escapeHtml("<!--[if !supportEmptyParas]-->")).join("");
        strMessageText = strMessageText.split(escapeHtml("<!--[endif]-->")).join("");
        jQuery("#contentTC").html(strMessageText);
    }
    
    function resizeInit(){
        var width = jQuery("#contentT").width();        
        parent.resizeHtmlTextFrame(350,width);
        setTimeout(function(){
            resizeFrame();
        },500);        
    }
    
    var cnt = 0;
    function resizeFrame(){     
        if(jQuery("#contentTC img").size() > 0){
            setTimeout(function(){
                if(cnt == 10) {
                    return;
                }
                cnt++;
                
                resizeFrameFunc();
                resizeFrame();
                
            }, 1000)
        }else{
            resizeFrameFunc();
            cnt++;
        }
    }
    
    function resizeFrameFunc(){
        var exHeight = 0;
        if(resizeDone || resizeCnt > 20){           
            jQuery("#contentBox").append("<br><br><br>");
        }

        if(jQuery.browser.msie){
            var reply = jQuery("blockQuote");
            jQuery("p").css({"word-wrap":"break-word","word-break":"break-all"});
            jQuery("span").css({"word-wrap":"break-word","word-break":"break-all"});        
            var mdn = jQuery("#TMSMDN");                
            if(mdn)exHeight = 40;
        }       
        var height = jQuery('#contentTC').height() + exHeight;      
        height = (height > 350)?height:350;     
        var width = jQuery("#contentT").width();
        parent.resizeHtmlTextFrame(height, width);
        resizeCnt++;

        if(!resizeDone && resizeCnt < 20){
            setTimeout(function(){resizeFrame()},1000);
        }
            
    }

    function init(){
        resizeDone = true;
        resizeFrame();
    }
     
</script>
</head>

<body onload="init();">
<div id="contentBox" style="width:98%">
    <table cellpadding="0" cellspacing="0" border="0" id="contentT" style="font-size:12px;width:100%;"><tr><td>
    <div id="contentTC">
    <script>
        setContent();
        resizeInit();       
    </script>
    </div>  
    </td></tr></table>
</div>
</body>
</html>
